<!-- survey-dashboard.component.html -->
<div class="survey-dashboard">
  <app-survey-navbar></app-survey-navbar>
    <!-- Filters and Search -->
  <div class="sub-navbar">
    <div class="sub-nav-card">
      <div class="sub-nav-items">
        <div class="surveys-count">
           Surveys 
        </div>
        <div class="filter-dropdowns">

          <div class="filter-dropdowns">
            <div class="dropdown-wrapper">
              <button class="actions-btn" (click)="toggleMenu($event)">Actions</button>
            </div>
          </div>

          <p-tieredMenu #menu [model]="items" popup="true"></p-tieredMenu>
        </div>
      </div>
    </div>
  </div>

  <!-- Filters and Search -->
  <div class="sub-navbar">
    <div class="sub-nav-card">
      <div class="sub-nav-items">
        <div class="surveys-count">
          Active Surveys ({{ totalSurveys() }})
        </div>

        <div class="search-container">
          <div class="search-wrapper">
            <svg class="search-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor">
              <circle cx="11" cy="11" r="8"></circle>
              <path d="m21 21-4.35-4.35"></path>
            </svg>
            <input
              type="text"
              placeholder="search by type, name..."
              [ngModel]="searchTerm()"
              (ngModelChange)="searchTerm.set($event)"
              (input)="onSearch()"
              class="search-input"
            />
          </div>
        </div>

        <div class="filter-dropdowns">
          <div class="dropdown-wrapper">
            <select
              [ngModel]="selectedYear()"
              (ngModelChange)="selectedYear.set($event); onYearChange()"
              class="filter-dropdown"
            >
              <option value="2025">2025</option>
              <option value="2024">2024</option>
              <option value="2023">2023</option>
            </select>
          </div>

          <div class="dropdown-wrapper">
            <select
              [ngModel]="selectedType()"
              (ngModelChange)="selectedType.set($event); onTypeChange()"
              class="filter-dropdown"
            >
              <option value="">Type</option>
              <option *ngFor="let t of typeOptions" [value]="t.label">
                {{ t.label }}
              </option>
            </select>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Survey Cards Grid -->
  <div class="sub-navbar">
    <div class="sub-nav-card">
      <div class="surveys-grid">
        <div class="grid-container">
          <div *ngIf="filteredSurveys().length === 0" class="empty-message">
            <i class="fa fa-info-circle info-icon"></i>
            There are no surveys to display
          </div>

<div class="survey-card survey-card--row" *ngFor="let survey of filteredSurveys()">
     <div class="card-header"><div class="survey-card__title">{{ survey.name }}</div>
  <!-- right side -->
    <button class="menu-btn" (click)="toggleCardMenu($event, survey)">
      <span class="menu-dots">â‹¯</span>
    </button>
    
</div>
    <div class="survey-card__metrics">
      <div class="chips">
        <div class="card-body"><div class="survey-card__desc">{{ survey.description }}</div></div>
<div class="survey-card__aside">
    <div class="survey-card__metrics">
      <div class="chips">
        <span class="chip chip-done">
          Completed
          <strong>{{ survey.stats?.completed || 0 }}</strong>
        </span>
        <span class="chip chip-idle">
          Not Touched
          <strong>{{ survey.stats?.notTouched || 0 }}</strong>
        </span>
        <span class="chip chip-progress">
          In Progress
          <strong>{{ survey.stats?.inProgress || 0}}</strong>
        </span>
      </div>
    </div>

</div>

</div>
</div>
    <div class="survey-card__metrics">
      <div class="chips">
  <!-- main -->
 
          
                  <span class="type-badge"
                     [ngStyle]="typeChipStyle(survey.typecolor)">
                     <span class="dot" [style.background-color]="getTypeColor(survey.typecolor)"></span>
                         {{ survey.typeLabel}}
                      </span>
  <div class="pill pill-anon" *ngIf="survey.isAnonymous !== false">ANONYMOUS</div>
     <div class="pill pill-anon" *ngIf="survey.isAnonymous !== true">Not ANONYMOUS</div>
      <div class="meta">
        <span class="meta-label">Due Date : </span>
        <span class="meta-value">{{survey.deadline | date:'MMM d, yyyy' }}</span>
      </div>


  </div>
  </div>


</div>

        </div>
      </div>
    </div>
  </div>
</div>

  <!-- Card Menu Dropdown -->
<div
  class="card-menu-dropdown"
  *ngIf="activeCardMenu()"
  [style.left.px]="menuPosition().x"
  [style.top.px]="menuPosition().y"
>
  <div class="menu-item" (click)="EditSurvey()" >Edit</div>
  <div class="menu-item" >View responses </div>
  <div class="menu-item" (click)="onComplete()" >complete</div>
</div>
